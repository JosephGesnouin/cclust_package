

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Basic Usage Examples &mdash; Coclust  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Coclust  documentation" href="index.html"/>
        <link rel="prev" title="Python API" href="api.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Coclust
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#ubuntu-debian">Ubuntu &amp; Debian</a><ul>
<li class="toctree-l3"><a class="reference internal" href="install.html#required">Required</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#optional">Optional</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#performance">Performance</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="scripts.html#process-co-clustering-the-coclust-script">Process co-clustering: the <em>coclust</em> script</a></li>
<li class="toctree-l2"><a class="reference internal" href="scripts.html#detect-the-best-number-of-co-clusters-the-coclust-nb-script">Detect the best number of co-clusters: the <em>coclust-nb</em> script</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Python API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-coclust.CoclustMod">coclust.CoclustMod module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#coclust-coclustspecmod-module">coclust.CoclustSpecMod module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#coclust-coclustinfo-module">coclust.CoclustInfo module</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Basic Usage Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#coclustmod">CoclustMod</a></li>
<li class="toctree-l2"><a class="reference internal" href="#coclustspecmod">CoclustSpecMod</a></li>
<li class="toctree-l2"><a class="reference internal" href="#coclustinfo">CoclustInfo</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Coclust</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Basic Usage Examples</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/examples.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="basic-usage-examples">
<h1>Basic Usage Examples<a class="headerlink" href="#basic-usage-examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="coclustmod">
<h2>CoclustMod<a class="headerlink" href="#coclustmod" title="Permalink to this headline">¶</a></h2>
<p>In the following example, the CSTR dataset is loaded from a matlab matrix using
the SciPy library. The data is stored in X and a co-clustering model using
direct maximisation of the modularity is then fitted with 4 clusters. The
modularity is printed and the predicted row labels and column labels are
retrieved for further exploration or evaluation.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">loadmat</span>
<span class="kn">from</span> <span class="nn">coclust.CoclustMod</span> <span class="kn">import</span> <span class="n">CoclustMod</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="s">&quot;datasets/cstr.mat&quot;</span>
<span class="n">matlab_dict</span> <span class="o">=</span> <span class="n">loadmat</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">matlab_dict</span><span class="p">[</span><span class="s">&#39;fea&#39;</span><span class="p">]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">CoclustMod</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">modularity</span><span class="p">)</span>
<span class="n">predicted_row_labels</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">row_labels_</span>
<span class="n">predicted_column_labels</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">column_labels_</span>
</pre></div>
</div>
<p>For example, the normalized mutual information score is computed using the
scikit-learn library:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics.cluster</span> <span class="kn">import</span> <span class="n">normalized_mutual_info_score</span> <span class="k">as</span> <span class="n">nmi</span>

<span class="n">true_row_labels</span> <span class="o">=</span> <span class="n">matlab_dict</span><span class="p">[</span><span class="s">&#39;gnd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">nmi</span><span class="p">(</span><span class="n">true_row_labels</span><span class="p">,</span> <span class="n">predicted_row_labels</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="coclustspecmod">
<h2>CoclustSpecMod<a class="headerlink" href="#coclustspecmod" title="Permalink to this headline">¶</a></h2>
<p>Here, the Classic3 dataset is imported as a CSV. The first line of the file is
the number of rows followed by the number of columns and the number of clusters
the model is fitted with. The other lines are tuples of row number, column
number and value of that entry. The spectral modularity based model is fitted
and the predicted row labels retrieved. The shapes of the predicted clusters
are printed.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">scipy.sparse</span> <span class="kn">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">coclust.CoclustSpecMod</span> <span class="kn">import</span> <span class="n">CoclustSpecMod</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="s">&quot;datasets/classic3.csv&quot;</span>
<span class="n">csv_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">csv_reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;,&quot;</span><span class="p">)</span>

<span class="n">nb_row</span><span class="p">,</span> <span class="n">nb_col</span><span class="p">,</span> <span class="n">nb_clusters</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">csv_reader</span><span class="o">.</span><span class="n">next</span><span class="p">())</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">lil_matrix</span><span class="p">((</span><span class="n">nb_row</span><span class="p">,</span> <span class="n">nb_col</span><span class="p">))</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csv_reader</span><span class="p">:</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
    <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">CoclustSpecMod</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">nb_clusters</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">predicted_row_labels</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">row_labels_</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_clusters</span><span class="p">):</span>
    <span class="n">number_of_rows</span><span class="p">,</span> <span class="n">number_of_columns</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_shape</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Cluster&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s">&quot;has&quot;</span><span class="p">,</span> <span class="n">number_of_rows</span><span class="p">,</span> <span class="s">&quot;rows and&quot;</span><span class="p">,</span>
          <span class="n">number_of_columns</span><span class="p">,</span> <span class="s">&quot;columns.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="coclustinfo">
<h2>CoclustInfo<a class="headerlink" href="#coclustinfo" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">coclust.CoclustInfo</span> <span class="kn">import</span> <span class="n">CoclustInfo</span>

<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_20newsgroups</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics.cluster</span> <span class="kn">import</span> <span class="n">normalized_mutual_info_score</span>

<span class="n">categories</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">&#39;rec.motorcycles&#39;</span><span class="p">,</span>
    <span class="s">&#39;rec.sport.baseball&#39;</span><span class="p">,</span>
    <span class="s">&#39;comp.graphics&#39;</span><span class="p">,</span>
    <span class="s">&#39;sci.space&#39;</span><span class="p">,</span>
    <span class="s">&#39;talk.politics.mideast&#39;</span>
<span class="p">]</span>

<span class="n">ng5</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">true_labels</span> <span class="o">=</span> <span class="n">ng5</span><span class="o">.</span><span class="n">target</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s">&#39;vect&#39;</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s">&#39;tfidf&#39;</span><span class="p">,</span> <span class="n">TfidfTransformer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s">&#39;coclust&#39;</span><span class="p">,</span> <span class="n">CoclustInfo</span><span class="p">()),</span>
<span class="p">])</span>

<span class="n">pipeline</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">coclust__n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ng5</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="n">predicted_labels</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s">&#39;coclust&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">row_labels_</span>

<span class="n">nmi</span> <span class="o">=</span> <span class="n">normalized_mutual_info_score</span><span class="p">(</span><span class="n">true_labels</span><span class="p">,</span> <span class="n">predicted_labels</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">nmi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="api.html" class="btn btn-neutral" title="Python API" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright .
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>